; PlatformIO Configuration for MultiGauge Dual-MCU CAN Bus Architecture
;
; Build commands:
;   pio run -e sensor_mcu      # Build ESP32-C3 sensor firmware
;   pio run -e display_mcu     # Build ESP32-S3 display firmware
;   pio run -e sensor_mcu -t upload
;   pio run -e display_mcu -t upload

[platformio]
default_envs = display_mcu

[env]
framework = arduino
monitor_speed = 115200

; ============================================================
; ESP32-C3 Sensor MCU
; Reads sensors and transmits over CAN bus
; ============================================================
[env:sensor_mcu]
platform = espressif32
board = esp32-c3-devkitm-1
; Also works with Waveshare ESP32-C3-Zero
build_flags =
    -D SENSOR_MCU
    -D ARDUINO_USB_CDC_ON_BOOT=1
    -I include/shared
build_src_filter =
    +<sensor_mcu/>
lib_deps =
    adafruit/Adafruit MAX31855 library@^1.3.0
    jonnieZG/EWMA@^1.0.1

; ============================================================
; ESP32-S3 Qualia Display MCU
; Receives CAN data and renders LVGL gauge display
; ============================================================
[env:display_mcu]
platform = espressif32
board = adafruit_qualia_s3_rgb666
build_flags =
    -D DISPLAY_MCU
    -D LV_CONF_INCLUDE_SIMPLE
    -D BOARD_HAS_PSRAM
    -I include/shared
build_src_filter =
    +<display_mcu/>
    +<../assets/>
lib_deps =
    lvgl/lvgl@^9.0.0
    moononournation/GFX Library for Arduino@^1.4.9
    tamctec/TAMC_GT911@^1.0.2
    jonnieZG/EWMA@^1.0.1
    adafruit/Adafruit BMP280 Library@^2.6.8  ; Optional: atmospheric pressure (I2C)
